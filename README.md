# CFP - CAPON FRONTEND PROCESSOR

> **å·¥ä¸šè§†è§‰æ£€æµ‹ç³»ç»Ÿ** - ä¸€ä¸ªæ”¯æŒå¤šç§å·¥ä¸šç›¸æœºçš„C++/Qtè§†è§‰æ£€æµ‹å¹³å°

## é¡¹ç›®æ¦‚è¿°

CFP (CAPON Frontend Processor) æ˜¯ä¸€ä¸ªåŸºäº C++ çš„å·¥ä¸šè§†è§‰æ£€æµ‹åº”ç”¨ï¼Œä¸“æ³¨äº DVP/IK/MINDç›¸æœºæ§åˆ¶ã€å›¾åƒé‡‡é›†ä¸å¤„ç†ï¼ˆå¦‚å­”æ´æ£€æµ‹ï¼‰ã€‚æœ¬é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒ OpenCV å›¾åƒå¤„ç†åŠŸèƒ½æŒ‰éœ€å¯ç”¨ï¼Œé€‚ç”¨äºå·¥ä¸šè‡ªåŠ¨åŒ–åœºæ™¯ã€‚

å½“å‰ç‰ˆæœ¬é»˜è®¤è¿è¡Œåœ¨ **å•æœºå•ç›¸æœºæ¨¡å¼** ä¸‹ï¼Œå³ä¸€å°ç”µè„‘æ§åˆ¶ä¸€ä¸ªç›¸æœºã€‚æ­¤æ¨¡å¼æ»¡è¶³å¤§å¤šæ•°ç°åœºéƒ¨ç½²éœ€æ±‚ï¼Œå…·å¤‡è‰¯å¥½çš„ç¨³å®šæ€§ä¸å®æ—¶æ€§ã€‚

> âš ï¸ æ³¨æ„ï¼šè™½ç„¶ç›®å‰åªä½¿ç”¨å•ç›¸æœºï¼Œä½†æˆ‘ä»¬å·²ç»å®ç°äº†å®Œæ•´çš„ **å¤šç›¸æœºæ¥å£æ¡†æ¶**ï¼Œä¸ºåç»­æ‰©å±•è‡³å¤šç›¸æœºç³»ç»Ÿåšå¥½å‡†å¤‡ã€‚å½“ç³»ç»Ÿå‡çº§ä¸ºå¤šç›¸æœºé…ç½®æ—¶ï¼Œæ‰€æœ‰ç›¸æœºå‡åœ¨åŒä¸€ä¸»æœºä¸Šè¿è¡Œï¼Œå› æ­¤æ— éœ€ä¾èµ– Redis è¿›è¡Œè·¨ä¸»æœºå˜é‡åŒæ­¥ï¼Œç®€åŒ–äº†æ¶æ„å¤æ‚åº¦ã€‚

åœ¨å½“å‰é˜¶æ®µï¼Œç³»ç»Ÿä»ç„¶éœ€è¦ Redis æ¥å¤„ç†åˆ†å¸ƒå¼é€šä¿¡éœ€æ±‚ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šå°æœºå™¨ä¹‹é—´åŒæ­¥çŠ¶æ€å’Œæ§åˆ¶ä¿¡å·ã€‚Redis PUB/SUB æœºåˆ¶è¢«ç”¨äºåè°ƒä¸»å‰ç«¯æœºï¼ˆ101ï¼‰å’Œå…¶ä»–å‰ç«¯æœºä¹‹é—´çš„é€šä¿¡ã€‚

---

## ç³»ç»Ÿé€šä¿¡æ¶æ„ï¼ˆåŸºäºå½“å‰è®¾è®¡ï¼‰

ä»¥ä¸‹ä¸ºç³»ç»Ÿå†…éƒ¨é€šä¿¡ç»“æ„ï¼Œæºè‡ªå®é™…éƒ¨ç½²é…ç½®ï¼š

| ç«¯å£       | æ–¹å‘             | è§’è‰²                          | å†…å®¹                                      | å‚ä¸è€…                     |
|------------|------------------|-------------------------------|-------------------------------------------|----------------------------|
| 7000       | æœåŠ¡å™¨ â†’ å‰ç«¯æœº | **101 ç›‘å¬ (TCP Server)**     | å¼€å§‹æ£€æµ‹ä¿¡å· `'o'` + å·å·               | ä»… 101*                    |
| 19800      | æœåŠ¡å™¨ â†’ å‰ç«¯æœº | **101 ç›‘å¬ (TCP Server)**     | åˆ†å‰²å®šä½å‚æ•°                              | ä»… 101*                    |
| 19300      | å‰ç«¯æœº â†’ æœåŠ¡å™¨ | **æ‰€æœ‰å‰ç«¯æœºä¸»åŠ¨è¿æ¥ (TCP Client)** | ç‰¹å¾ `'F'` / çŠ¶æ€ `'T'`                 | 101 + æ‰€æœ‰å…¶ä»–å‰ç«¯æœº       |
| 19700      | 101 â†’ æœåŠ¡å™¨    | **101 ä¸»åŠ¨è¿æ¥ (TCP Client)** | å·é•¿/å®½/é€Ÿåº¦/å·å·/çŠ¶æ€ï¼ˆæœåŠ¡å™¨ç•Œé¢æ˜¾ç¤ºï¼‰ | ä»… 101*                    |

> ğŸ” è¯´æ˜ï¼š
>
> - `101` ä»£è¡¨ä¸»æ§æœåŠ¡å™¨èŠ‚ç‚¹ï¼›
> - æ‰€æœ‰å‰ç«¯æœºé€šè¿‡ TCP å®¢æˆ·ç«¯ä¸»åŠ¨è¿æ¥åˆ°æœåŠ¡å™¨ï¼›
> - æœåŠ¡å™¨ç›‘å¬å¤šä¸ªç«¯å£ï¼Œåˆ†åˆ«ç”¨äºä¸åŒç±»å‹çš„æŒ‡ä»¤ä¼ è¾“ï¼›
> - å¤šç›¸æœºæ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªç›¸æœºå¯è§†ä¸ºä¸€ä¸ªå‰ç«¯æœºï¼Œå…±äº«åŒä¸€æœåŠ¡å™¨æ§åˆ¶é€»è¾‘ã€‚
> - è¿™é‡Œçš„"ä»…101"è¡¨ç¤ºåˆ°æ˜¯101ä½œä¸ºå‰ç«¯æœºåˆ°ä¸»èŠ‚ç‚¹ç»Ÿä¸€äº†å‰ç«¯æœºå’ŒæœåŠ¡å™¨ä¹‹é—´åˆ°é€šè®¯ï¼Œå®é™…ä¸Šæ‰€æœ‰å‰ç«¯æœºéƒ½è¦å‘å¸ƒè‡ªèº«çŠ¶æ€åˆ°101ä¸Šç»Ÿä¸€ç®¡ç†,åŒç†æœåŠ¡å™¨å‘é€çš„è¯·æ±‚ä¹Ÿç”±101ç»Ÿä¸€å‘é€ç»™æ‰€æœ‰åˆ°å…¶ä»–å‰ç«¯æœº

---

## Redis åˆ†å¸ƒå¼é€šä¿¡æ¶æ„

åœ¨å½“å‰éƒ¨ç½²ä¸­ï¼Œç³»ç»Ÿä½¿ç”¨ Redis ä½œä¸ºåˆ†å¸ƒå¼é€šä¿¡ä¸­é—´ä»¶ï¼Œç”¨äºåŒæ­¥å¤šå°æœºå™¨ä¹‹é—´çš„çŠ¶æ€å’Œæ§åˆ¶ä¿¡å·ï¼š

- **Redis PUB/SUB**: ç”¨äºåœ¨ä¸»å‰ç«¯æœºï¼ˆ101ï¼‰å’Œå…¶ä»–å‰ç«¯æœºä¹‹é—´ä¼ é€’æ§åˆ¶ä¿¡å·å’ŒçŠ¶æ€æ›´æ–°
- **Redis é”®å€¼å­˜å‚¨**: ç”¨äºå­˜å‚¨å…±äº«é…ç½®å’Œä¸´æ—¶çŠ¶æ€ä¿¡æ¯
- **ä¸»æ§èŠ‚ç‚¹ï¼ˆ101ï¼‰**: è´Ÿè´£å‘å¸ƒæ§åˆ¶ä¿¡å·å¹¶èšåˆé¥æµ‹æ•°æ®
- **ä»å±èŠ‚ç‚¹**: æ¥æ”¶æ§åˆ¶ä¿¡å·å¹¶å‘é€é¥æµ‹æ•°æ®

> æ³¨æ„ï¼šåœ¨æœªæ¥çš„å¤šç›¸æœºæ¨¡å¼ä¸‹ï¼ˆæ‰€æœ‰ç›¸æœºåœ¨åŒä¸€ä¸»æœºä¸Šï¼‰ï¼Œå°†ä¸å†éœ€è¦ Redis è¿›è¡Œè·¨ä¸»æœºåŒæ­¥ï¼Œå› ä¸ºæ‰€æœ‰ç»„ä»¶éƒ½åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œã€‚
---

## åŠ¨æ€ç®—æ³•åº“è®¾è®¡ï¼ˆæœªæ¥è§„åˆ’ï¼‰

ä¸ºäº†æé«˜ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬è®¡åˆ’å®ç°åŠ¨æ€ç®—æ³•åº“æœºåˆ¶ï¼š

- **æ’ä»¶åŒ–ç®—æ³•æ¶æ„**: æ‰€æœ‰ç®—æ³•ç±»å°†é€šè¿‡ç»Ÿä¸€æ¥å£è¿›è¡Œè§„çº¦ï¼Œå®ç°ç®—æ³•çš„åŠ¨æ€åŠ è½½å’Œæ›¿æ¢
- **åŠ¨æ€åº“æ”¯æŒ**: ç®—æ³•å°†ä»¥åŠ¨æ€åº“ï¼ˆDLL/.soï¼‰å½¢å¼å­˜åœ¨ï¼Œæ”¯æŒè¿è¡Œæ—¶åŠ è½½
- **è¿œç¨‹æ›´æ–°èƒ½åŠ›**: æœåŠ¡å™¨å¯æ¨é€æ–°çš„ç®—æ³•åº“åˆ°å‰ç«¯æœºï¼Œæ— éœ€é‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨
- **ç°åœºä¼˜åŒ–**: å‰ç«¯æœºå¯è‡ªè¡Œæ›¿æ¢è¡¨ç°ä¸ä½³çš„ç®—æ³•ï¼Œè¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–
- **å…ƒæ•°æ®ç®¡ç†**: æ¯ä¸ªç®—æ³•åŒ…å«å…ƒä¿¡æ¯ï¼ˆå‚æ•°åˆ—è¡¨ã€å¤„ç†æ­¥éª¤ã€ç‰ˆæœ¬ç­‰ï¼‰ï¼Œä¾¿äºç®¡ç†å’ŒéªŒè¯
- **çƒ­æ’æ‹”**: æ”¯æŒåœ¨ä¸åœæœºçš„æƒ…å†µä¸‹åŠ¨æ€æ›¿æ¢ç®—æ³•åº“

è¿™ç§è®¾è®¡å°†å…è®¸æˆ‘ä»¬åœ¨ä¸è¿œç¨‹è®¿é—®å®¢æˆ·ä¸»æœºé‡æ–°ç¼–è¯‘ç¨‹åºçš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€æ›¿æ¢æŸäº›è¡¨ç°ä¸ä½³çš„ç°åœºç®—æ³•ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œé€‚åº”æ€§ã€‚

---

## é¡¹ç›®æ¶æ„ä¸ç›®å½•ç»“æ„

```
CFP Project Structure
â”œâ”€â”€ DOCS                    # è®¾è®¡æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ algorithm_signal_mechanism.md
â”‚   â”œâ”€â”€ client_design.md
â”‚   â”œâ”€â”€ communication_protocol.md
â”‚   â”œâ”€â”€ dynamic_algorithm_design.md
â”‚   â”œâ”€â”€ multi_camera_interface.md
â”‚   â””â”€â”€ system_architecture.md
â”œâ”€â”€ cmake                   # CMakeæ¨¡å—å’Œè„šæœ¬
â”‚   â”œâ”€â”€ ApplyPatch.cmake
â”‚   â”œâ”€â”€ DeployQt.cmake
â”‚   â”œâ”€â”€ FindDVP2.cmake
â”‚   â”œâ”€â”€ FindIKap.cmake
â”‚   â””â”€â”€ find_Qt_Dependency.cmake
â”œâ”€â”€ examples                # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ basic_example.cpp
â”‚   â”œâ”€â”€ generic_camera_example.cpp
â”‚   â””â”€â”€ multi_camera_example.cpp
â”œâ”€â”€ include                 # å¤´æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ algo                # ç®—æ³•ç›¸å…³å¤´æ–‡ä»¶
â”‚   â”œâ”€â”€ business            # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ cameras             # ç›¸æœºç›¸å…³ç±» (Dvp, Ikap)
â”‚   â”œâ”€â”€ config              # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ protocol            # é€šä¿¡åè®®
â”‚   â”œâ”€â”€ redis               # Rediså®¢æˆ·ç«¯
â”‚   â””â”€â”€ utils               # å·¥å…·å‡½æ•°
â”œâ”€â”€ patches                 # è¡¥ä¸æ–‡ä»¶
â”œâ”€â”€ script                  # Pythonè„šæœ¬
â”œâ”€â”€ src                     # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ algo                # ç®—æ³•å®ç°
â”‚   â”œâ”€â”€ business            # ä¸šåŠ¡é€»è¾‘å®ç°
â”‚   â”œâ”€â”€ cameras             # ç›¸æœºç›¸å…³å®ç° (Dvp, Ikap)
â”‚   â”œâ”€â”€ client              # å®¢æˆ·ç«¯UIå®ç°
â”‚   â”œâ”€â”€ protocol            # é€šä¿¡åè®®å®ç°
â”‚   â”œâ”€â”€ redis               # Rediså®¢æˆ·ç«¯å®ç°
â”‚   â””â”€â”€ utils               # å·¥å…·å‡½æ•°å®ç°
â”œâ”€â”€ tests                   # æµ‹è¯•ä»£ç 
â”œâ”€â”€ third_party             # ç¬¬ä¸‰æ–¹åº“
â”‚   â”œâ”€â”€ AntDesign           # UIåº“
â”‚   â”œâ”€â”€ BS_THREAD_POOL      # çº¿ç¨‹æ± åº“
â”‚   â”œâ”€â”€ DVP_SDK             # DVPç›¸æœºSDK
â”‚   â”œâ”€â”€ IKap                # IKç›¸æœºSDK
â”‚   â”œâ”€â”€ asio                # å¼‚æ­¥I/Oåº“
â”‚   â”œâ”€â”€ concurrentqueue     # å¹¶å‘é˜Ÿåˆ—
â”‚   â”œâ”€â”€ cpp_redis           # Rediså®¢æˆ·ç«¯
â”‚   â””â”€â”€ googletest          # æµ‹è¯•æ¡†æ¶
â””â”€â”€ CMakeLists.txt          # CMakeæ„å»ºé…ç½®
```

## æ¶æ„ç‰¹æ€§

- âœ… æ”¯æŒ OpenCV æŒ‰éœ€å¯ç”¨ï¼ˆCMake æ§åˆ¶ï¼‰
- âœ… ä½¿ç”¨ vcpkg ç»Ÿä¸€ç®¡ç†ç¬¬ä¸‰æ–¹ä¾èµ–
- âœ… æ”¯æŒ Debug/Release ä¸åŒé“¾æ¥ç­–ç•¥
- âœ… é«˜åº¦æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºç®—æ³•æ›¿æ¢
- âœ… å·²å®ç°å¤šç›¸æœºæ¥å£æ¡†æ¶ï¼ˆæœªæ¥å¯ç”¨ï¼‰
- âœ… æ”¯æŒå¤šç§å·¥ä¸šç›¸æœºï¼ˆDVP/IK/MINDï¼‰
- âœ… å½“å‰é˜¶æ®µä½¿ç”¨ Redis è¿›è¡Œè·¨ä¸»æœºçŠ¶æ€åŒæ­¥
- âœ… æœªæ¥å¦‚æœå¤šç›¸æœºæ¨¡å¼æ›´ä¼˜ç§€ï¼Œåˆ™ä¸å†éœ€è¦ Redis è·¨ä¸»æœºåŒæ­¥ï¼ˆå› æ‰€æœ‰ç»„ä»¶åœ¨åŒä¸€ä¸»æœºï¼‰
- âœ… è§„åˆ’åŠ¨æ€ç®—æ³•åº“æ”¯æŒï¼ˆæœªæ¥å®ç°ï¼‰

---

## é¡¹ç›®æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CFP Architecture                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Client Layer (UI)                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  DvpMainWindow  DvpCameraView  DvpConfigModel  DvpCameraManager         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Communication & Protocol Layer                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ProtocolSession  AsioTcpTransport  LegacyCodec  TransportAdapter       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Redis Communication Layer                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  IRedisClient  RedisClient  DistributedStateSync                       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Multi-Camera Coordination Layer                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  MultiCameraCoordinator  FrameProcessor  CapturedFrame                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Application Layer                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  DvpCameraBuilder  DvpCameraCapture  DvpEventManager  FrameProcessor    â”‚â”‚
â”‚  â”‚  IkapCameraBuilder IkapCameraCapture IkapEventManager                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Camera Management Layer                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  CameraFactory  CameraManager  CameraCapture  DvpCameraManager          â”‚â”‚
â”‚  â”‚  IkapCameraManager  DvpCameraManager                                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Configuration Layer                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  DvpConfig  IkapConfig  ConfigManager  CameraConfig  AlogoParams         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Algorithm Layer                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  AlgoBase  GenericAlgorithmConfigObserver  HoleDetection                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DVP/IK/MIND SDK Layer                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  dvpHandle  dvpOpen  dvpStart  dvpRegisterStreamCallback                 â”‚â”‚
â”‚  â”‚  ikapHandle ikapOpen ikapStart ikapRegisterStreamCallback                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ¨¡å—å…³ç³»è¯¦è§£

### 1. CameraCapture ä¸ FrameProcessor

```
CameraCapture â†’ FrameProcessor â†’ AlgoAdapter â†’ AlgoBase
```

- [CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)æ˜¯ç›¸æœºæ•è·çš„æ ¸å¿ƒæŠ½è±¡ç±»ï¼Œè´Ÿè´£ä¸ç›¸æœºSDKäº¤äº’
- [FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)æ˜¯å¤„ç†å›¾åƒå¸§çš„æ¥å£ï¼Œå®šä¹‰äº†`process`æ–¹æ³•
- [CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)é€šè¿‡`user_processor_`æˆå‘˜å˜é‡æŒæœ‰[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)å®ä¾‹
- å½“ç›¸æœºäº§ç”Ÿæ–°å¸§æ—¶ï¼Œ[CameraCapture::process_frame](file:///d:/codespace/CFP/src/cameras/DvpCameraCapture.cpp#L114-L135)å°†å¸§æ•°æ®ä¼ é€’ç»™[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)è¿›è¡Œå¤„ç†

### 2. Camera Management æ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Camera Management Architecture                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CameraFactory â†’ CameraManager â†’ CameraCapture â†’ Camera SDK                 â”‚
â”‚        â†“            â†“              â†“                                         â”‚
â”‚   Create Cameras  Manage List   Capture Frames                              â”‚
â”‚        â†“            â†“              â†“                                         â”‚
â”‚   CameraCapture â† CameraConfig â† DvpConfig/IkapConfig                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- [CameraFactory](file:///d:/codespace/CFP/include/cameras/CameraFactory.hpp#L10-L27)è´Ÿè´£åˆ›å»ºä¸åŒç±»å‹çš„ç›¸æœºå®ä¾‹ï¼ˆDVP/IK/MINDï¼‰
- [CameraManager](file:///d:/codespace/CFP/include/cameras/CameraManager.hpp#L13-L56)ç®¡ç†å¤šä¸ªç›¸æœºå®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ
- [CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)å®šä¹‰äº†ç›¸æœºæ•è·çš„æŠ½è±¡æ¥å£
- [DvpCameraCapture](file:///d:/codespace/CFP/include/cameras/Dvp/DvpCameraCapture.hpp#L15-L72)å’Œ[IkapCameraCapture](file:///d:/codespace/CFP/include/cameras/Ikap/IkapCameraCapture.hpp#L15-L72)æ˜¯å…·ä½“å®ç°
- [CameraConfig](file:///d:/codespace/CFP/include/config/CameraConfig.hpp#L6-L14)å®šä¹‰ç›¸æœºé…ç½®å‚æ•°ç»“æ„

### 3. Protocol Communication æ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Protocol Communication Architecture                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ICodec â† LegacyCodec  â†â†’  ITransportAdapter â†â†’ AsioTcpTransport           â”‚
â”‚    â†“              â†“                    â†“                â†“                   â”‚
â”‚ Encode/Decode   Legacy            Send/Receive      TCP Transport           â”‚
â”‚ Config Data    Format            Protocol Data      (Future: gRPC)          â”‚
â”‚    â†“              â†“                    â†“                â†“                   â”‚
â”‚ ProtocolSession â†’ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’                   â”‚
â”‚ (Manage Session)                      â”‚                                     â”‚
â”‚                                       â†“                                     â”‚
â”‚                                Client/Server                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- [ICodec](file:///d:/codespace/CFP/include/protocol/codec.hpp#L8-L17)å®šä¹‰ç¼–ç è§£ç æ¥å£
- [LegacyCodec](file:///d:/codespace/CFP/include/protocol/LegacyCodec.hpp#L7-L15)å®ç°ä¼ ç»Ÿåè®®ç¼–è§£ç 
- [ITransportAdapter](file:///d:/codespace/CFP/include/protocol/TransportAdapter.hpp#L10-L22)å®šä¹‰ä¼ è¾“é€‚é…å™¨æ¥å£
- [AsioTcpTransport](file:///d:/codespace/CFP/include/protocol/AsioTcpTransport.hpp#L12-L32)å®ç°TCPä¼ è¾“
- [ProtocolSession](file:///d:/codespace/CFP/include/protocol/ProtocolSession.hpp#L15-L37)ç®¡ç†åè®®ä¼šè¯
- [messages.hpp](file:///d:/codespace/CFP/include/protocol/messages.hpp)å®šä¹‰åè®®æ¶ˆæ¯æ ¼å¼

### 4. MultiCameraCoordinator å¤šç›¸æœºåè°ƒå™¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MultiCameraCoordinator Architecture                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Camera 1 â†’ FrameProcessor â†’ MultiCameraCoordinator â†’ DownstreamProcessor  â”‚
â”‚       â†“            â†“              â†“                    â†“                   â”‚
â”‚  Camera 2 â†’ FrameProcessor â†’ MultiCameraCoordinator â†’ Frame Fusion        â”‚
â”‚       â†“            â†“              â†“                    â†“                   â”‚
â”‚  Camera N â†’ FrameProcessor â†’ MultiCameraCoordinator â†’ Algorithm Processing â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- [MultiCameraCoordinator](file:///d:/codespace/CFP/include/cameras/MultiCameraCoordinator.hpp#L14-L56)æ˜¯å¤šç›¸æœºåè°ƒå¤„ç†çš„æ ¸å¿ƒç»„ä»¶
- æ¥æ”¶æ¥è‡ªå¤šä¸ªç›¸æœºçš„å¸§æ•°æ®
- ä½¿ç”¨èåˆå‡½æ•°å°†å¤šä¸ªå¸§æ•°æ®åˆå¹¶ä¸ºå•ä¸ªèåˆå¸§
- é€šè¿‡`make_processor_for()`æ–¹æ³•ä¸ºæ¯ä¸ªç›¸æœºåˆ›å»ºä¸“ç”¨çš„[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)
- æä¾›`operator[]`æ“ä½œç¬¦é‡è½½ï¼Œä¾¿äºè®¿é—®ç‰¹å®šç›¸æœºçš„å¤„ç†å™¨
- æ”¯æŒä¸‹æ¸¸å¤„ç†å™¨ï¼Œå¯å°†èåˆåçš„å¸§ä¼ é€’ç»™ç®—æ³•å¤„ç†
- çº¿ç¨‹å®‰å…¨ï¼Œä½¿ç”¨äº’æ–¥é”ä¿æŠ¤å…±äº«èµ„æº

### 5. Algo ä¸ FrameProcessor äº¤äº’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Algo-FrameProcessor Interaction                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Camera Data â†’ CameraCapture â†’ FrameProcessor â†’ AlgoAdapter â†’ AlgoBase     â”‚
â”‚        â†“            â†“            â†“             â†“            â†“             â”‚
â”‚   Raw Frame    OnFrameCallback  process()   AlgoAdapter   process()         â”‚
â”‚                                         â†“                                  â”‚
â”‚                                  Algo Implementation                       â”‚
â”‚                                         â†“                                  â”‚
â”‚                                   emit_image() â†’ ImageSignalBus            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- [AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)æ˜¯æ‰€æœ‰å›¾åƒå¤„ç†ç®—æ³•çš„æŠ½è±¡åŸºç±»
- [AlgoAdapter](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L136-L150)æ˜¯é€‚é…å™¨ç±»ï¼Œç»§æ‰¿[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)å¹¶æŒæœ‰[AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)å®ä¾‹
- å½“ç›¸æœºå¸§åˆ°è¾¾æ—¶ï¼Œæ‰§è¡Œè·¯å¾„ä¸ºï¼š
  1. [CameraCapture::process_frame](file:///d:/codespace/CFP/src/cameras/DvpCameraCapture.cpp#L114-L135)è°ƒç”¨[FrameProcessor::process](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L55-L58)
  2. å®é™…æ‰§è¡Œ[AlgoAdapter::process](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L145-L147)ï¼Œå°†å¸§ä¼ é€’ç»™[AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)
  3. [AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)çš„æ´¾ç”Ÿç±»å®ç°å…·ä½“çš„ç®—æ³•é€»è¾‘
  4. ç®—æ³•é€šè¿‡[emit_image](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L102-L106)æ–¹æ³•å°†ç»“æœå‘é€åˆ°[ImageSignalBus](file:///d:/codespace/CFP/include/cameras/ImageSignalBus.hpp#L28-L74)

### 6. ç®—æ³•æºä¿¡æ¯å®ä¸å®¢æˆ·ç«¯ä¿¡å·æºè®¢é˜…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Algorithm Metadata & Signal Channels                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Algorithm Class â†’ ALGO_METADATA â†’ Source Info â†’ UI â†’ Signal Channels      â”‚
â”‚        â†“              â†“              â†“            â†“            â†“            â”‚
â”‚   HoleDetection   "HoleDetection"  get_name()  Client     Subscribe        â”‚
â”‚        â†“              â†“              â†“            â†“            â†“            â”‚
â”‚   get_signal_info() â†’ Signals      â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’ â†’   â”‚
â”‚   "OriginalImage", "ProcessedImage", "DefectOverlay", etc.                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- æ¯ä¸ªç®—æ³•ç±»ä½¿ç”¨`ALGO_METADATA`å®æ³¨å†Œç®—æ³•çš„å…ƒä¿¡æ¯ï¼ˆåç§°å’Œæè¿°ï¼‰
- ç®—æ³•ç±»å®ç°`get_signal_info()`æ–¹æ³•ï¼Œè¿”å›æ‰€æœ‰å¯è¾“å‡ºçš„ä¿¡å·æºä¿¡æ¯
- å®¢æˆ·ç«¯UIå¯é€šè¿‡`get_signal_info()`è·å–ç®—æ³•æ”¯æŒçš„ä¿¡å·æºåˆ—è¡¨
- å®¢æˆ·ç«¯å¯ä»¥è®¢é˜…å„ç§å¤„ç†é˜¶æ®µçš„å›¾åƒä¿¡å·ï¼Œå¦‚ï¼š
  - åŸå§‹è¾“å…¥å›¾åƒ
  - é¢„å¤„ç†åå›¾åƒ
  - ç®—æ³•å¤„ç†ç»“æœå›¾åƒ
  - ç¼ºé™·æ ‡æ³¨å›¾åƒ
- é€šè¿‡`emit_image()`æ–¹æ³•å‘å¸ƒä¸åŒé˜¶æ®µçš„å›¾åƒåˆ°ä¿¡å·æ€»çº¿
- UIç»„ä»¶å¯ä»¥åŠ¨æ€æ·»åŠ ä¿¡å·æºï¼Œå®ç°å¯¹ä¸åŒå¤„ç†é˜¶æ®µå›¾åƒçš„å®æ—¶ç›‘æ§

### 7. ImageSignalBus ä¿¡å·æ€»çº¿

- [ImageSignalBus](file:///d:/codespace/CFP/include/cameras/ImageSignalBus.hpp#L28-L74)ä½œä¸ºå›¾åƒä¿¡å·çš„å‘å¸ƒ-è®¢é˜…ç³»ç»Ÿ
- ç®—æ³•é€šè¿‡[emit_image](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L102-L106)æ–¹æ³•å‘å¸ƒå¤„ç†ç»“æœ
- UIç»„ä»¶æˆ–å…¶ä»–æ¨¡å—å¯ä»¥è®¢é˜…ç‰¹å®šä¿¡å·åç§°çš„å›¾åƒæ•°æ®

## æ‰§è¡Œæµç¨‹

### 1. åˆå§‹åŒ–é˜¶æ®µ

```
CameraBuilder â†’ build() â†’ CameraCapture â†’ Open Camera â†’ åˆå§‹åŒ–é…ç½®
```

- ä½¿ç”¨[CameraFactory](file:///d:/codespace/CFP/include/cameras/CameraFactory.hpp#L10-L27)æˆ–å…·ä½“ç›¸æœºçš„Builderç±»æ„å»ºç›¸æœºå®ä¾‹
- é€šè¿‡ç›¸æœºIDã€å‹å¥½åç§°æˆ–ç´¢å¼•æ‰“å¼€ç›¸æœº
- åº”ç”¨é…ç½®å‚æ•°ï¼ˆROIã€æ›å…‰ã€å¢ç›Šç­‰ï¼‰
- åˆ›å»º[CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)å®ä¾‹å¹¶æ³¨å†Œå¸§å›è°ƒ

### 2. å¤šç›¸æœºåè°ƒå¤„ç†æµç¨‹

```
MultiCameraCoordinator(num_cams, fusion_func) â†’ make_processor_for(i) â†’ on_frame(i, frame) â†’ fuse_func
```

- åˆ›å»º[MultiCameraCoordinator](file:///d:/codespace/CFP/include/cameras/MultiCameraCoordinator.hpp#L14-L56)å®ä¾‹ï¼ŒæŒ‡å®šç›¸æœºæ•°é‡å’Œèåˆå‡½æ•°
- ä¸ºæ¯ä¸ªç›¸æœºè°ƒç”¨`make_processor_for()`æ–¹æ³•åˆ›å»ºå¯¹åº”çš„[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)
- æ¯ä¸ªç›¸æœºçš„å¸§æ•°æ®é€šè¿‡`on_frame()`æ–¹æ³•è¿›å…¥åè°ƒå™¨
- å½“æ‰€æœ‰ç›¸æœºçš„å¸§æ•°æ®éƒ½åˆ°è¾¾æ—¶ï¼Œæ‰§è¡Œèåˆå‡½æ•°
- å°†èåˆåçš„å¸§ä¼ é€’ç»™ä¸‹æ¸¸å¤„ç†å™¨è¿›è¡Œç®—æ³•å¤„ç†

### 3. ç®—æ³•é…ç½®é˜¶æ®µ

```
ConfigManager â†’ create_algorithm() â†’ AlgoAdapter â†’ AlgoBase
```

- [ConfigManager](file:///d:/codespace/CFP/include/config/ConfigManager.hpp#L24-L49)è´Ÿè´£åˆ›å»ºå’Œç®¡ç†ç®—æ³•å®ä¾‹
- `create_algorithm<T>()`æ–¹æ³•åˆ›å»ºå…·ä½“ç®—æ³•å®ä¾‹å¹¶åŒ…è£…åœ¨[AlgoAdapter](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L136-L150)ä¸­
- ç®—æ³•å¯ä»¥å£°æ˜å…¶éœ€è¦çš„ä¿¡å·æºï¼ˆé€šè¿‡`declare_signals`ï¼‰
- [AlgoAdapter](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L136-L150)å°†ç®—æ³•é€‚é…ä¸º[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)æ¥å£

### 4. é…ç½®é˜¶æ®µ

```
CameraConfig â†’ set_config() â†’ update_camera_params() â†’ åº”ç”¨åˆ°SDK
```

- é€šè¿‡[set_config](file:///d:/codespace/CFP/src/cameras/DvpCameraCapture.cpp#L58-L64)æ–¹æ³•åŠ¨æ€æ›´æ–°ç›¸æœºé…ç½®
- é…ç½®å‚æ•°åŒ…æ‹¬ï¼š
  - æ›å…‰æ—¶é—´
  - æ¨¡æ‹Ÿå¢ç›Š
  - ç¡¬ä»¶ISPçŠ¶æ€
  - ROIåŒºåŸŸ
  - è‡ªåŠ¨æ›å…‰/å¢ç›Š
  - è§¦å‘æ¨¡å¼
  - é‡‡é›†å¸§ç‡

### 5. æ•è·é˜¶æ®µ

```
start() â†’ Start Camera â†’ OnFrameCallback â†’ process_frame â†’ user_processor
```

- å¯åŠ¨ç›¸æœºæ•è·
- SDKè§¦å‘å¸§å›è°ƒ
- [CameraCapture::OnFrameCallback](file:///d:/codespace/CFP/src/cameras/DvpCameraCapture.cpp#L106-L112)æ¥æ”¶åŸå§‹æ•°æ®
- [process_frame](file:///d:/codespace/CFP/src/cameras/DvpCameraCapture.cpp#L114-L135)å¤„ç†å¸§æ•°æ®
- ä½¿ç”¨çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œç”¨æˆ·å®šä¹‰çš„å¸§å¤„ç†å™¨
- å°†åŸå§‹å›¾åƒå­˜å…¥é˜Ÿåˆ—ä¾›åç»­å¤„ç†

### 6. ç®—æ³•å¤„ç†é˜¶æ®µ

```
FrameProcessor::process() â†’ AlgoAdapter::process() â†’ AlgoBase::process() â†’ ç®—æ³•å®ç°
```

- å¸§æ•°æ®é€šè¿‡[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)æ¥å£ä¼ é€’
- [AlgoAdapter](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L136-L150)å°†è°ƒç”¨è½¬å‘åˆ°[AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)å®ç°
- ç®—æ³•å¤„ç†å›¾åƒæ•°æ®
- ç®—æ³•é€šè¿‡[ImageSignalBus](file:///d:/codespace/CFP/include/cameras/ImageSignalBus.hpp#L28-L74)å‘å¸ƒå¤„ç†ç»“æœ

### 7. äº‹ä»¶å¤„ç†

```
register_event_handler() â†’ EventManager â†’ å¤„ç†ç›¸æœºäº‹ä»¶
```

- é€šè¿‡[EventManager](file:///d:/codespace/CFP/include/cameras/Dvp/DvpEventManager.hpp#L16-L32)æ³¨å†Œäº‹ä»¶å¤„ç†å™¨
- ç›‘å¬ç›¸æœºçŠ¶æ€å˜åŒ–
- å¤„ç†é”™è¯¯å’Œå¼‚å¸¸æƒ…å†µ

### 8. åè®®é€šä¿¡é˜¶æ®µ

```
Client Request â†’ ProtocolSession â†’ LegacyCodec â†’ AsioTcpTransport â†’ Server
```

- å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚
- [ProtocolSession](file:///d:/codespace/CFP/include/protocol/ProtocolSession.hpp#L15-L37)ç®¡ç†é€šä¿¡ä¼šè¯
- [LegacyCodec](file:///d:/codespace/CFP/include/protocol/LegacyCodec.hpp#L7-L15)ç¼–ç /è§£ç æ•°æ®
- [AsioTcpTransport](file:///d:/codespace/CFP/include/protocol/AsioTcpTransport.hpp#L12-L32)å¤„ç†TCPä¼ è¾“
- æœåŠ¡ç«¯æ¥æ”¶å¹¶å¤„ç†è¯·æ±‚

## æ ¸å¿ƒç»„ä»¶

### Protocol Communication Components

- [ICodec](file:///d:/codespace/CFP/include/protocol/codec.hpp#L8-L17) - å®šä¹‰åè®®ç¼–è§£ç æ¥å£
- [LegacyCodec](file:///d:/codespace/CFP/include/protocol/LegacyCodec.hpp#L7-L15) - å®ç°ä¼ ç»Ÿåè®®ç¼–è§£ç 
- [ITransportAdapter](file:///d:/codespace/CFP/include/protocol/TransportAdapter.hpp#L10-L22) - å®šä¹‰ä¼ è¾“æ¥å£
- [AsioTcpTransport](file:///d:/codespace/CFP/include/protocol/AsioTcpTransport.hpp#L12-L32) - åŸºäºAsioçš„TCPä¼ è¾“å®ç°
- [ProtocolSession](file:///d:/codespace/CFP/include/protocol/ProtocolSession.hpp#L15-L37) - ç®¡ç†åè®®ä¼šè¯
- [messages.hpp](file:///d:/codespace/CFP/include/protocol/messages.hpp) - å®šä¹‰åè®®æ¶ˆæ¯æ ¼å¼

### Camera Management Components

- [CameraFactory](file:///d:/codespace/CFP/include/cameras/CameraFactory.hpp#L10-L27) - ç›¸æœºåˆ›å»ºå·¥å‚
- [CameraManager](file:///d:/codespace/CFP/include/cameras/CameraManager.hpp#L13-L56) - ç›¸æœºç®¡ç†å™¨
- [CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18) - ç›¸æœºæ•è·æ¥å£
- [DvpCameraCapture](file:///d:/codespace/CFP/include/cameras/Dvp/DvpCameraCapture.hpp#L15-L72) - DVPç›¸æœºæ•è·å®ç°
- [IkapCameraCapture](file:///d:/codespace/CFP/include/cameras/Ikap/IkapCameraCapture.hpp#L15-L72) - IKç›¸æœºæ•è·å®ç°
- [CameraConfig](file:///d:/codespace/CFP/include/config/CameraConfig.hpp#L6-L14) - ç›¸æœºé…ç½®ç»“æ„

### MultiCameraCoordinator

- å¤šç›¸æœºåè°ƒå¤„ç†æ ¸å¿ƒç»„ä»¶
- è´Ÿè´£æ”¶é›†å¤šä¸ªç›¸æœºçš„å¸§æ•°æ®
- å®ç°å¸§æ•°æ®çš„åŒæ­¥å’Œèåˆ
- æä¾›çº¿ç¨‹å®‰å…¨çš„å¸§å¤„ç†æœºåˆ¶
- æ”¯æŒä¸‹æ¸¸å¤„ç†å™¨é“¾å¼å¤„ç†

### CameraCapture

- ç›¸æœºæ•è·çš„æ ¸å¿ƒç±»
- å°è£…ç›¸æœºSDKåŠŸèƒ½
- ç®¡ç†ç›¸æœºçŠ¶æ€å’Œé…ç½®
- æä¾›çº¿ç¨‹å®‰å…¨çš„é…ç½®æ›´æ–°

### CameraBuilder

- ç›¸æœºå®ä¾‹æ„å»ºå™¨
- é“¾å¼APIé…ç½®ç›¸æœºå‚æ•°
- ç®€åŒ–ç›¸æœºåˆ›å»ºè¿‡ç¨‹

### EventManager

- äº‹ä»¶å¤„ç†ç®¡ç†å™¨
- æ³¨å†Œå’Œåˆ†å‘ç›¸æœºäº‹ä»¶
- ç›‘å¬ç›¸æœºçŠ¶æ€å˜åŒ–

### FrameProcessor

- å¸§å¤„ç†æ¥å£
- å®šä¹‰å›¾åƒå¤„ç†å›è°ƒ
- æ”¯æŒè‡ªå®šä¹‰ç®—æ³•å®ç°

### AlgoBase

- æ‰€æœ‰å›¾åƒç®—æ³•çš„æŠ½è±¡åŸºç±»
- å®šä¹‰ç®—æ³•æ¥å£å’Œé…ç½®æœºåˆ¶
- é€šè¿‡[AlgoAdapter](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L136-L150)é€‚é…åˆ°[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)æ¥å£

### AlgoAdapter

- é€‚é…å™¨ç±»ï¼Œå°†[AlgoBase](file:///d:/codespace/CFP/include/algo/AlgoBase.hpp#L32-L105)ç®—æ³•é€‚é…ä¸º[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)æ¥å£
- ä½¿ç®—æ³•å¯ä»¥ä½œä¸ºå¸§å¤„ç†å™¨ä½¿ç”¨

### ImageSignalBus

- å›¾åƒä¿¡å·æ€»çº¿
- å‘å¸ƒ-è®¢é˜…æ¨¡å¼ä¼ è¾“å›¾åƒæ•°æ®
- è§£è€¦ç®—æ³•å’ŒUIæ˜¾ç¤º

### CameraConfig

- ç›¸æœºé…ç½®æ•°æ®ç»“æ„
- åŒ…å«æ‰€æœ‰ç›¸æœºå‚æ•°
- æ”¯æŒåŠ¨æ€æ›´æ–°

## çº¿ç¨‹æ¨¡å‹

```
Main Thread: UI and Camera Control
â”œâ”€â”€ CameraCapture Thread: Frame Callbacks
â”‚   â””â”€â”€ BS Thread Pool: Image Processing
â”‚       â”œâ”€â”€ FrameProcessor (AlgoAdapter)
â”‚       â”‚   â””â”€â”€ AlgoBase Implementation
â”‚       â””â”€â”€ ImageSignalBus (Publish Results)
â”œâ”€â”€ MultiCameraCoordinator Thread: Frame Synchronization
â”‚   â””â”€â”€ Fusion Processing â†’ Downstream Processor
â”œâ”€â”€ Protocol Communication Thread: Network I/O
â”‚   â””â”€â”€ AsioTcpTransport â†’ LegacyCodec â†’ Messages
â””â”€â”€ Event Manager Thread: Camera Events
```

- ä¸»çº¿ç¨‹å¤„ç†UIå’Œç›¸æœºæ§åˆ¶
- [CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)çº¿ç¨‹å¤„ç†SDKå›è°ƒ
- çº¿ç¨‹æ± å¼‚æ­¥æ‰§è¡Œå›¾åƒç®—æ³•
- [MultiCameraCoordinator](file:///d:/codespace/CFP/include/cameras/MultiCameraCoordinator.hpp#L14-L56)çº¿ç¨‹å¤„ç†å¤šç›¸æœºå¸§åŒæ­¥å’Œèåˆ
- äº‹ä»¶ç®¡ç†å™¨å¤„ç†ç›¸æœºäº‹ä»¶
- åè®®é€šä¿¡å¤„ç†ç½‘ç»œI/O

## æ•°æ®æµ

```
Camera 1 Raw Data â†’ CameraCapture â†’ FrameProcessor â†’ MultiCameraCoordinator
Camera 2 Raw Data â†’ CameraCapture â†’ FrameProcessor â†’ MultiCameraCoordinator â†’ Frame Fusion â†’ Algorithm
Camera N Raw Data â†’ CameraCapture â†’ FrameProcessor â†’ MultiCameraCoordinator
                      â†“
              Configuration Manager â† Dynamic Updates
                      â†“
        ProtocolSession â† â†’ Transport â†’ Server/Client
```

- åŸå§‹ç›¸æœºæ•°æ®è¿›å…¥[CameraCapture](file:///d:/codespace/CFP/include/cameras/CameraCapture.hpp#L8-L18)
- æ¯ä¸ªç›¸æœºçš„å¸§æ•°æ®é€šè¿‡å¯¹åº”çš„[FrameProcessor](file:///d:/codespace/CFP/include/cameras/FrameProcessor.hpp#L52-L65)ä¼ é€’ç»™[MultiCameraCoordinator](file:///d:/codespace/CFP/include/cameras/MultiCameraCoordinator.hpp#L14-L56)
- [MultiCameraCoordinator](file:///d:/codespace/CFP/include/cameras/MultiCameraCoordinator.hpp#L14-L56)æ”¶é›†æ‰€æœ‰ç›¸æœºçš„å¸§æ•°æ®
- æ‰§è¡Œèåˆå‡½æ•°ç”Ÿæˆèåˆå¸§
- å°†èåˆå¸§ä¼ é€’ç»™ä¸‹æ¸¸ç®—æ³•å¤„ç†
- é…ç½®ç®¡ç†å™¨åŠ¨æ€æ›´æ–°å‚æ•°
- åè®®ä¼šè¯å¤„ç†é€šä¿¡

## å®¢æˆ·ç«¯ä¿¡å·æºè®¢é˜…æœºåˆ¶

å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å’Œè®¢é˜…ç®—æ³•å¤„ç†è¿‡ç¨‹ä¸­çš„ä¸åŒä¿¡å·æºï¼š

1. **è·å–ç®—æ³•ä¿¡æ¯**ï¼š
   - é€šè¿‡`get_name()`å’Œ`get_description()`è·å–ç®—æ³•åç§°å’Œæè¿°
   - é€šè¿‡`get_parameter_info()`è·å–ç®—æ³•å¯é…ç½®å‚æ•°ä¿¡æ¯
   - é€šè¿‡`get_signal_info()`è·å–ç®—æ³•å¯è¾“å‡ºçš„ä¿¡å·æºä¿¡æ¯

2. **ä¿¡å·æºæ³¨å†Œ**ï¼š
   - ç®—æ³•ç±»ä½¿ç”¨`ALGO_METADATA`å®æ³¨å†Œå…ƒä¿¡æ¯
   - å®ç°`get_signal_info()`æ–¹æ³•è¿”å›æ‰€æœ‰æ”¯æŒçš„ä¿¡å·æº
   - ç®—æ³•åœ¨å¤„ç†è¿‡ç¨‹ä¸­é€šè¿‡`emit_image()`å‘å¸ƒä¸åŒé˜¶æ®µçš„å›¾åƒ

3. **å®¢æˆ·ç«¯è®¢é˜…**ï¼š
   - UIç»„ä»¶å¯ä»¥è·å–æ‰€æœ‰å¯ç”¨çš„ä¿¡å·æºåˆ—è¡¨
   - åŠ¨æ€æ·»åŠ ä¿¡å·æºåˆ°æ˜¾ç¤ºç•Œé¢
   - å®æ—¶è®¢é˜…ä¸åŒå¤„ç†é˜¶æ®µçš„å›¾åƒæ•°æ®

4. **ä¿¡å·æºç±»å‹**ï¼š
   - åŸå§‹è¾“å…¥å›¾åƒ
   - é¢„å¤„ç†åå›¾åƒ
   - ç®—æ³•å¤„ç†ç»“æœ
   - ç¼ºé™·æ ‡æ³¨å›¾åƒ
   - å…¶ä»–ä¸­é—´å¤„ç†ç»“æœ

## æœªæ¥è®¡åˆ’ï¼šgRPCæ”¯æŒ

æˆ‘ä»¬è®¡åˆ’å¼•å…¥gRPCæ”¯æŒä»¥æä¾›æ›´ç°ä»£å’Œé«˜æ•ˆçš„é€šä¿¡æ–¹å¼ï¼š

```
// GrpcCodec.hpp
class GrpcCodec : public protocol::ICodec {
  std::vector<uint8_t> encode_config(const ServerConfig& config) override {
    // è½¬æ¢ä¸º protobuf å¯¹è±¡
    defect_proto::ConfigRequest request;
    request.set_roll_id(config.roll_id);
    // ...
    return request.SerializeAsString();
  }
};

// GrpcTransport.hpp
class GrpcTransport : public protocol::ITransportAdapter {
  void async_send(std::span<const uint8_t> data, SendCallback cb) override {
    // è°ƒç”¨ gRPC stub
    stub_->SendConfig(&context, request, &response, cb);
  }
};
```

- [ICodec](file:///d:/codespace/CFP/include/protocol/codec.hpp#L8-L17)æ¥å£å°†ç”¨äºå®ç°gRPCç¼–è§£ç 
- [ITransportAdapter](file:///d:/codespace/CFP/include/protocol/TransportAdapter.hpp#L10-L22)æ¥å£å°†ç”¨äºå®ç°gRPCä¼ è¾“
- ä½¿ç”¨Protocol Buffersè¿›è¡Œæ•°æ®åºåˆ—åŒ–
- æä¾›æ›´å¥½çš„è·¨è¯­è¨€æ”¯æŒå’Œæ€§èƒ½

## è¯¦ç»†æ–‡æ¡£

æ›´å¤šæŠ€æœ¯ç»†èŠ‚è¯·å‚è§ `DOCS/` ç›®å½•ä¸‹çš„è®¾è®¡æ–‡æ¡£ï¼š

- [DOCS/communication_protocol.md](file:///d:/codespace/CFP/DOCS/communication_protocol.md): è¯¦ç»†æè¿°ç³»ç»Ÿä¸­å„ä¸ªç»„ä»¶ä¹‹é—´çš„é€šä¿¡åè®®
- [DOCS/system_architecture.md](file:///d:/codespace/CFP/DOCS/system_architecture.md): è¯¦ç»†æè¿°ç³»ç»Ÿæ•´ä½“æ¶æ„è®¾è®¡
- [DOCS/multi_camera_interface.md](file:///d:/codespace/CFP/DOCS/multi_camera_interface.md): è¯¦ç»†æè¿°å¤šç›¸æœºæ¥å£è®¾è®¡å’Œå®ç°æ–¹æ¡ˆ
- [DOCS/dynamic_algorithm_design.md](file:///d:/codespace/CFP/DOCS/dynamic_algorithm_design.md): è¯¦ç»†æè¿°åŠ¨æ€ç®—æ³•åº“çš„è®¾è®¡æ–¹æ¡ˆ
- [DOCS/client_design.md](file:///d:/codespace/CFP/DOCS/client_design.md): è¯¦ç»†æè¿°å®¢æˆ·ç«¯ç•Œé¢è®¾è®¡å’Œä¿¡å·è®¢é˜…æœºåˆ¶
- [DOCS/algorithm_signal_mechanism.md](file:///d:/codespace/CFP/DOCS/algorithm_signal_mechanism.md): è¯¦ç»†æè¿°ç®—æ³•ä¿¡å·å‘å¸ƒä¸è®¢é˜…æœºåˆ¶

---

## æœªæ¥è§„åˆ’

- [ ] æ¨å‡ºå¤šç›¸æœºå¹¶è¡Œå¤„ç†æ¨¡å¼ï¼ˆæ¥å£å·²å°±ç»ªï¼‰
- [ ] å°†è¯¦ç»†é€šä¿¡åè®®ä¸çŠ¶æ€æœºè®¾è®¡ç§»å…¥ `DOCS/` ç›®å½•
- [ ] å®ç°è‡ªåŠ¨åŒ–çš„ç›¸æœºçƒ­æ’æ‹”ä¸è´Ÿè½½å‡è¡¡
- [ ] å¢åŠ  Web ç•Œé¢è¿œç¨‹ç›‘æ§æ”¯æŒ
- [ ] å®ç°åŠ¨æ€ç®—æ³•åº“æœºåˆ¶
- [ ] å®Œå–„IKå’ŒMINDç›¸æœºæ”¯æŒ
- [ ] å¢åŠ æ›´å¤šç®—æ³•ç±»å‹æ”¯æŒ

## ä¾èµ–åº“

- DVP SDK: DVPç›¸æœºåº•å±‚é©±åŠ¨
- IKap SDK: IKç›¸æœºåº•å±‚é©±åŠ¨
- Asio: å¼‚æ­¥I/Oåº“ (ç”¨äºç½‘ç»œé€šä¿¡)
- BS Thread Pool: çº¿ç¨‹æ± ç®¡ç†
- Concurrent Queue: å¹¶å‘é˜Ÿåˆ—
- OpenCV: å›¾åƒå¤„ç†ï¼ˆç®—æ³•éƒ¨åˆ†ï¼‰
- Qt: UIæ¡†æ¶ï¼ˆå®¢æˆ·ç«¯éƒ¨åˆ†ï¼‰
- redis-cpp: Rediså®¢æˆ·ç«¯åº“
